<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="CertificadoFichaPersonal" pageWidth="595" pageHeight="842" whenNoDataType="AllSectionsNoDetail" columnWidth="505" leftMargin="45" rightMargin="45" topMargin="0" bottomMargin="0" uuid="239ba6dc-edaa-45af-829a-d8b59f2a543d">
	<property name="ireport.zoom" value="2.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<style name="negrita" pdfFontName="Helvetica-Bold"/>
	<parameter name="ID_CERTIFICADO" class="java.lang.Long"/>
	<parameter name="SUBREPORT_DIR" class="java.lang.String">
		<defaultValueExpression><![CDATA["C:\\Users\\Anyelo\\Desktop\\NetBeansProjects\\portoviejo-registro\\src\\main\\webapp\\reportes\\registro\\"]]></defaultValueExpression>
	</parameter>
	<parameter name="USER_NAME" class="java.lang.String"/>
	<parameter name="NOMBRES" class="java.lang.String"/>
	<parameter name="REGISTRADOR" class="java.lang.String"/>
	<parameter name="HEADER_URL" class="java.lang.String"/>
	<parameter name="FOOTER_URL" class="java.lang.String"/>
	<parameter name="WATERMARK_URL" class="java.lang.String"/>
	<parameter name="SOLICITANTE" class="java.lang.String"/>
	<parameter name="USO_DOCUMENTO" class="java.lang.String"/>
	<parameter name="FIRMA_DIGITAL" class="java.lang.String"/>
	<queryString>
		<![CDATA[select ficha.fecha_ape, ficha.num_ficha, ce.clave_catastral as codigo_predial, ce.linderos_registrales as linderos, ce.parroquia as nombre_parroquia,
coalesce(en.apellidos, '') || ' ' || coalesce(en.nombres, '') as user_ingreso,
(to_char(ce.fecha_emision, 'yyyy')||'-'||ce.num_tramite)
as codigo_certificado, ce.num_certificado, ce.fecha_emision, ce.observacion
as solvencia, liq.codigo_comprobante, parroquia.descripcion as parroquia,
ce.fecha_creacion as fecha_certificado, coalesce(uc.apellidos, '') || ' ' || coalesce(uc.nombres, '') as user_certificado, ce.url_foto, ce.descripcion_bien,
(select razon_reporte from app.reg_registrador where actual is true)
as accion_personal, ce.cod_verificacion, liq.tramite_online,
'https://www.registropropiedadjipijapa.gob.ec/api/certf/' || ce.cod_verificacion as qrcode,
ce.num_tramite
from app.reg_certificado ce
left join app.reg_ficha as ficha on (ficha.id = ce.ficha)
left join app.cat_parroquia as parroquia on (parroquia.id = ficha.parroquia)
left join app.acl_user us on (us.usuario = ficha.user_ingreso)
left join app.cat_ente en on (en.id = us.ente)
left join app.acl_user cr on (cr.id = ce.user_creador)
left join app.cat_ente uc on (uc.id = cr.ente)
left join flow.regp_tareas_tramite tt on tt.id = ce.tarea_tramite
left join flow.regp_liquidacion_detalles ld on ld.id = tt.detalle
left join flow.regp_liquidacion liq on liq.id = ld.liquidacion
where ce.id = $P{ID_CERTIFICADO}]]>
	</queryString>
	<field name="fecha_ape" class="java.sql.Timestamp"/>
	<field name="num_ficha" class="java.lang.Long"/>
	<field name="codigo_predial" class="java.lang.String"/>
	<field name="linderos" class="java.lang.String"/>
	<field name="nombre_parroquia" class="java.lang.String"/>
	<field name="user_ingreso" class="java.lang.String"/>
	<field name="codigo_certificado" class="java.lang.String"/>
	<field name="num_certificado" class="java.lang.Long"/>
	<field name="fecha_emision" class="java.sql.Timestamp"/>
	<field name="solvencia" class="java.lang.String"/>
	<field name="codigo_comprobante" class="java.lang.String"/>
	<field name="parroquia" class="java.lang.String"/>
	<field name="fecha_certificado" class="java.sql.Timestamp"/>
	<field name="user_certificado" class="java.lang.String"/>
	<field name="url_foto" class="java.lang.String"/>
	<field name="descripcion_bien" class="java.lang.String"/>
	<field name="accion_personal" class="java.lang.String"/>
	<field name="cod_verificacion" class="java.lang.String"/>
	<field name="tramite_online" class="java.lang.Boolean"/>
	<field name="qrcode" class="java.lang.String"/>
	<field name="num_tramite" class="java.lang.Long"/>
	<background>
		<band height="840" splitType="Stretch">
			<image scaleImage="FillFrame" hAlign="Center" vAlign="Middle">
				<reportElement x="-44" y="0" width="593" height="840" uuid="198b5e3d-5c0f-43ce-936a-3d1a530994ac"/>
				<imageExpression><![CDATA[$P{WATERMARK_URL}]]></imageExpression>
			</image>
		</band>
	</background>
	<pageHeader>
		<band height="105" splitType="Stretch"/>
	</pageHeader>
	<detail>
		<band height="78" splitType="Stretch">
			<staticText>
				<reportElement style="negrita" positionType="Float" x="0" y="44" width="250" height="16" uuid="aa1fe9cc-a910-45ed-a96e-f93ad00e45a5"/>
				<textElement verticalAlignment="Middle">
					<font isBold="false" isUnderline="false"/>
				</textElement>
				<text><![CDATA[1.- DESCRIPCIÓN:]]></text>
			</staticText>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement positionType="Float" x="327" y="14" width="178" height="13" uuid="62d1d335-7625-4e3b-99d1-4d65bcf8be97"/>
				<box>
					<leftPen lineWidth="0.5"/>
					<bottomPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{codigo_predial}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement style="negrita" positionType="Float" mode="Opaque" x="327" y="1" width="178" height="13" backcolor="#CCCCCC" uuid="18284d01-8795-40cc-a741-e9f26bd1a057"/>
				<box>
					<topPen lineWidth="0.5"/>
					<leftPen lineWidth="0.5"/>
					<rightPen lineWidth="0.5"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font isBold="false" isUnderline="false"/>
				</textElement>
				<text><![CDATA[FICHA PERSONAL Nº]]></text>
			</staticText>
			<staticText>
				<reportElement style="negrita" positionType="Float" x="0" y="0" width="95" height="14" uuid="8d0641b9-bde8-4297-bf39-2c7b80cd9722"/>
				<textElement verticalAlignment="Middle">
					<font size="8" isBold="false"/>
				</textElement>
				<text><![CDATA[Nº de Certificado:]]></text>
			</staticText>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement positionType="Float" x="95" y="0" width="232" height="14" uuid="ffc79a03-8103-4eaf-acf9-910cb022af86"/>
				<textElement verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[java.lang.String.format("%08d", $F{num_certificado})]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement style="negrita" positionType="Float" x="0" y="14" width="95" height="14" uuid="bb3c14ef-dd95-4b2e-8c8a-1169a8cab6b5"/>
				<textElement verticalAlignment="Middle">
					<font size="8" isBold="false"/>
				</textElement>
				<text><![CDATA[Fecha de Emisión:]]></text>
			</staticText>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement positionType="Float" x="95" y="14" width="232" height="14" uuid="72c11879-6913-47ae-bfe2-180da4704557"/>
				<textElement verticalAlignment="Middle"/>
				<textFieldExpression><![CDATA[$F{fecha_emision}]]></textFieldExpression>
				<patternExpression><![CDATA["dd MMMMM yyyy HH:mm"]]></patternExpression>
			</textField>
			<staticText>
				<reportElement style="negrita" mode="Opaque" x="0" y="28" width="505" height="16" forecolor="#000000" backcolor="#CCCCCC" uuid="e5048cef-94a9-408b-873f-d1a5e3c6f7f6"/>
				<textElement textAlignment="Center" verticalAlignment="Middle">
					<font size="12" isBold="false"/>
				</textElement>
				<text><![CDATA[CERTIFICADO FICHA PERSONAL]]></text>
			</staticText>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement positionType="Float" mode="Transparent" x="20" y="60" width="485" height="16" isPrintWhenDetailOverflows="true" uuid="12ab0b9e-39b6-45dc-a35a-765815dc9aab"/>
				<textElement textAlignment="Justified" verticalAlignment="Top">
					<font size="10"/>
					<paragraph spacingAfter="5"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{linderos}]]></textFieldExpression>
			</textField>
		</band>
		<band height="75" splitType="Stretch">
			<subreport runToBottom="false">
				<reportElement positionType="Float" x="0" y="52" width="505" height="20" isRemoveLineWhenBlank="true" uuid="519fffd3-b0a0-423b-a672-a5e4c6bbe5d5"/>
				<subreportParameter name="SUBREPORT_DIRINTERNO">
					<subreportParameterExpression><![CDATA[$P{SUBREPORT_DIR}]]></subreportParameterExpression>
				</subreportParameter>
				<subreportParameter name="ID_CERTIFICADO">
					<subreportParameterExpression><![CDATA[$P{ID_CERTIFICADO}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR} + "CertificadoHistoriaMovimientosMercantil.jasper"]]></subreportExpression>
			</subreport>
			<subreport>
				<reportElement positionType="Float" x="0" y="16" width="505" height="20" isRemoveLineWhenBlank="true" uuid="376731b4-9a94-40a7-89a0-fc7c6ac21a9b"/>
				<subreportParameter name="ID_CERTIFICADO">
					<subreportParameterExpression><![CDATA[$P{ID_CERTIFICADO}]]></subreportParameterExpression>
				</subreportParameter>
				<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
				<subreportExpression><![CDATA[$P{SUBREPORT_DIR} + "CertificadoHistoriaResumenMovimientosMercantil.jasper"]]></subreportExpression>
			</subreport>
			<staticText>
				<reportElement style="negrita" positionType="Float" x="0" y="0" width="300" height="16" uuid="8947426b-6f82-4786-99d6-ea70930fec49"/>
				<textElement verticalAlignment="Middle">
					<font isBold="false" isUnderline="false"/>
				</textElement>
				<text><![CDATA[2.- RESUMEN DE MOVIMIENTOS REGISTRALES:]]></text>
			</staticText>
			<staticText>
				<reportElement style="negrita" positionType="Float" x="0" y="36" width="300" height="16" uuid="f5c3d37d-f4e5-4b23-b634-17e69b9d2cac"/>
				<textElement verticalAlignment="Middle">
					<font isBold="false" isUnderline="false"/>
				</textElement>
				<text><![CDATA[3.- DETALLE DE CADA MOVIMIENTO:]]></text>
			</staticText>
		</band>
		<band height="55" splitType="Stretch">
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement style="negrita" positionType="Float" x="0" y="0" width="505" height="55" isRemoveLineWhenBlank="true" uuid="db88bdd0-e828-4aea-9018-f48c23c659e6">
					<printWhenExpression><![CDATA[$F{accion_personal} != null && !$F{accion_personal}.isEmpty()]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Justified" verticalAlignment="Top" markup="none">
					<font size="10"/>
					<paragraph lineSpacing="Single"/>
				</textElement>
				<textFieldExpression><![CDATA["4.- RAZÓN: " + $F{accion_personal}.toUpperCase()]]></textFieldExpression>
			</textField>
		</band>
		<band height="170" splitType="Stretch">
			<textField isBlankWhenNull="true">
				<reportElement x="60" y="8" width="230" height="8" isPrintWhenDetailOverflows="true" uuid="dc47752f-481f-4377-a7c3-e419126d86c8"/>
				<textElement verticalAlignment="Middle">
					<font size="6" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{NOMBRES}]]></textFieldExpression>
			</textField>
			<textField pattern="dd/MM/yyyy HH.mm.ss" isBlankWhenNull="true">
				<reportElement x="60" y="15" width="230" height="8" isPrintWhenDetailOverflows="true" uuid="d34725a0-30ce-4dfa-9755-f5032474fa29"/>
				<textElement verticalAlignment="Middle">
					<font size="6" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="130" y="23" width="375" height="50" isPrintWhenDetailOverflows="true" uuid="d9eb9cd9-0ab4-4684-96a5-d7469ba33d9a"/>
				<box leftPadding="3" rightPadding="3">
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.0"/>
					<rightPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Justified" verticalAlignment="Middle">
					<font size="6"/>
				</textElement>
				<text><![CDATA[1. Los movimientos registrales, datos y fechas que constan en este documento son los que se refieren al inmueble que se certifica y que se encuentran vigentes hasta la fecha de emisión del mismo.
2. Cualquier enmendadura, alteración o modificación al texto de este documento lo invalida.
3. El interesado debe comunicar cualquier novedad en este documento al Registro de la Propiedad y Mercantil.
4. La responsabilidad sobre la veracidad de los datos registrados es exclusiva del declarante cuando este provee la información, en correspondencia al Artículo 4 de la Ley de la SINARDAP.]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="8" width="60" height="8" isPrintWhenDetailOverflows="true" uuid="0b43eecb-4d5d-47b2-b229-390bea885005"/>
				<textElement verticalAlignment="Middle">
					<font size="6" isBold="false"/>
				</textElement>
				<text><![CDATA[Impreso por:]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="15" width="60" height="8" isPrintWhenDetailOverflows="true" uuid="0990c6a2-728e-438f-a7fb-6d0a51a29a88"/>
				<textElement verticalAlignment="Middle">
					<font size="6" isBold="false"/>
				</textElement>
				<text><![CDATA[F. Impresión:]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="1" width="60" height="8" isPrintWhenDetailOverflows="true" uuid="e6b2a575-f313-4281-858e-9ebf4bb417be"/>
				<textElement verticalAlignment="Middle">
					<font size="6" isBold="false"/>
				</textElement>
				<text><![CDATA[Creado por:]]></text>
			</staticText>
			<textField isBlankWhenNull="true">
				<reportElement x="60" y="1" width="230" height="8" isPrintWhenDetailOverflows="true" uuid="61670b73-dfbf-48c7-a0f6-4cb70641dd19"/>
				<textElement verticalAlignment="Middle">
					<font size="6" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{user_certificado}.toUpperCase()]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement style="negrita" x="0" y="141" width="250" height="28" isPrintWhenDetailOverflows="true" uuid="fee2cbcc-c0e4-45f7-809c-3348b296ef00"/>
				<box>
					<topPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Top">
					<font isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{REGISTRADOR}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="0" y="23" width="130" height="50" isPrintWhenDetailOverflows="true" uuid="b5a57939-36a0-4870-a6bb-a99953fa9f5a"/>
				<box>
					<topPen lineWidth="1.0"/>
					<leftPen lineWidth="1.0"/>
					<bottomPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Bottom">
					<font size="7"/>
				</textElement>
				<text><![CDATA[Firma de Responsabilidad]]></text>
			</staticText>
			<image scaleImage="FillFrame" hAlign="Center" vAlign="Middle" onErrorType="Blank">
				<reportElement x="80" y="107" width="90" height="34" isPrintWhenDetailOverflows="true" uuid="bacb3fd9-5861-4adb-ba65-51fa8217c32a"/>
				<imageExpression><![CDATA[$P{FIRMA_DIGITAL}]]></imageExpression>
			</image>
			<staticText>
				<reportElement x="350" y="73" width="155" height="16" isPrintWhenDetailOverflows="true" uuid="d992a06e-94a5-4d0f-be10-a12e155bb1ee">
					<printWhenExpression><![CDATA[$F{cod_verificacion} != null]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Right" verticalAlignment="Middle"/>
				<text><![CDATA[Código de Verificación]]></text>
			</staticText>
			<textField>
				<reportElement style="negrita" x="350" y="89" width="155" height="20" isPrintWhenDetailOverflows="true" uuid="ed8169b6-6180-4af2-a2e4-564407ecd73e">
					<printWhenExpression><![CDATA[$F{cod_verificacion} != null]]></printWhenExpression>
				</reportElement>
				<textElement textAlignment="Right">
					<font size="14" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{cod_verificacion}]]></textFieldExpression>
			</textField>
			<image>
				<reportElement x="444" y="109" width="60" height="60" isPrintWhenDetailOverflows="true" uuid="93644652-d670-497f-a30d-9f6784a99726">
					<printWhenExpression><![CDATA[$F{cod_verificacion} != null]]></printWhenExpression>
				</reportElement>
				<imageExpression><![CDATA[com.google.zxing.client.j2se.MatrixToImageWriter.toBufferedImage(
    new com.google.zxing.qrcode.QRCodeWriter().encode(
        $F{qrcode},
        com.google.zxing.BarcodeFormat.QR_CODE, 300, 300
    ))]]></imageExpression>
			</image>
			<textField isBlankWhenNull="true">
				<reportElement x="360" y="8" width="144" height="8" isPrintWhenDetailOverflows="true" uuid="27c64dc7-24c0-446b-8c96-2ed0933901e5"/>
				<textElement verticalAlignment="Middle">
					<font size="6" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{codigo_predial}]]></textFieldExpression>
			</textField>
			<textField isBlankWhenNull="true">
				<reportElement x="360" y="1" width="144" height="8" isPrintWhenDetailOverflows="true" uuid="516d80dd-396c-403f-b1bb-70fa08a84813"/>
				<textElement verticalAlignment="Middle">
					<font size="6" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[java.lang.String.format("%08d", $F{num_certificado})]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="290" y="15" width="70" height="8" isPrintWhenDetailOverflows="true" uuid="9a153e7c-6cdd-4e1a-b647-aa6bba3b317a"/>
				<textElement verticalAlignment="Middle">
					<font size="6" isBold="false"/>
				</textElement>
				<text><![CDATA[Fecha Emisión:]]></text>
			</staticText>
			<staticText>
				<reportElement x="290" y="8" width="70" height="8" isPrintWhenDetailOverflows="true" uuid="b98cc669-f6f6-4881-9141-13e4cd7e03eb"/>
				<textElement verticalAlignment="Middle">
					<font size="6" isBold="false"/>
				</textElement>
				<text><![CDATA[Nro. de Ficha:]]></text>
			</staticText>
			<textField isBlankWhenNull="true">
				<reportElement x="360" y="15" width="144" height="8" isPrintWhenDetailOverflows="true" uuid="816d3979-b7d2-43ce-825c-e84857ab0eb5"/>
				<textElement verticalAlignment="Middle">
					<font size="6" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{fecha_emision}]]></textFieldExpression>
				<patternExpression><![CDATA["dd MMMMM yyyy HH:mm"]]></patternExpression>
			</textField>
			<staticText>
				<reportElement x="290" y="1" width="70" height="8" isPrintWhenDetailOverflows="true" uuid="588a8c22-baea-4fb8-a148-fcf83067a32d"/>
				<textElement verticalAlignment="Middle">
					<font size="6" isBold="false"/>
				</textElement>
				<text><![CDATA[Nro. Certificado:]]></text>
			</staticText>
		</band>
	</detail>
	<pageFooter>
		<band height="52" splitType="Stretch">
			<textField>
				<reportElement x="412" y="0" width="52" height="12" uuid="15595584-b0fb-42a2-8b14-c26e87bf4aa1"/>
				<textElement verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA["Página: "+$V{PAGE_NUMBER}+" de"]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement x="465" y="0" width="40" height="12" uuid="5235b8b5-8800-4915-bf6f-d819b4082772"/>
				<textElement verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement style="negrita" x="0" y="0" width="405" height="12" uuid="576315c5-e61c-4105-b51c-59ea23621d62"/>
				<box rightPadding="2"/>
				<textElement verticalAlignment="Middle">
					<font size="7" isBold="false"/>
				</textElement>
				<text><![CDATA[VALIDEZ DEL CERTIFICADO TÉRMINO DE 30 DÍAS A PARTIR DE LA FECHA DE EMISIÓN]]></text>
			</staticText>
		</band>
	</pageFooter>
</jasperReport>
