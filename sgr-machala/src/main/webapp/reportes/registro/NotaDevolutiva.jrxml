<?xml version="1.0" encoding="UTF-8"?>
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="NotaDevolutiva" language="groovy" pageWidth="595" pageHeight="842" columnWidth="455" leftMargin="70" rightMargin="70" topMargin="0" bottomMargin="0" uuid="e70bf7b3-10e4-457b-953e-a72467c75fab">
	<property name="ireport.zoom" value="2.0"/>
	<property name="ireport.x" value="0"/>
	<property name="ireport.y" value="0"/>
	<style name="html" fill="Solid" markup="html" isBlankWhenNull="true" fontSize="10" isBold="false" isItalic="false" isUnderline="false" isStrikeThrough="false" pdfFontName="Helvetica" pdfEncoding="Cp1250" isPdfEmbedded="true"/>
	<style name="style_bold" isBold="true" isItalic="false" isUnderline="false" pdfFontName="Helvetica-Bold"/>
	<parameter name="ID_NOTA" class="java.lang.Long">
		<defaultValueExpression><![CDATA[]]></defaultValueExpression>
	</parameter>
	<parameter name="WATERMARK_URL" class="java.lang.String"/>
	<parameter name="JURIDICA" class="java.lang.String"/>
	<parameter name="REGISTRADOR" class="java.lang.String"/>
	<parameter name="USUARIO" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT nd.num_nota_devolutiva, nd.fecha, li.inscripcion, nd.firma, nd.elaborado,
case e.es_persona when true then coalesce(e.nombres,'')||' '||coalesce(e.apellidos,'')
else e.razon_social end AS nota_para, nd.asunto, nd.elaborado, nd.fecha, nd.fecha_ingreso,
coalesce(eu.apellidos,'')  || ' ' ||  coalesce(eu.nombres,'') as hecho,
coalesce(ej.apellidos,'')  || ' ' ||  coalesce(ej.nombres,'') as juridica,
nd.detalle as descripcion, li.repertorio, li.fecha_ingreso as fecha_pago,
li.codigo_comprobante, to_char(li.fecha_ingreso,'yyyy') as anio, li.num_tramite_rp as num_tramite
FROM flow.regp_nota_devolutiva nd
inner join app.cat_ente e on nd.para = e.id
left outer join app.acl_user us on us.usuario = nd.realizado
inner join app.cat_ente eu on us.ente = eu.id
left outer join app.acl_user uj on uj.usuario = nd.elaborado
inner join app.cat_ente ej on uj.ente = ej.id
left join flow.regp_liquidacion li on li.tramite = nd.tramite
where nd.ID = $P{ID_NOTA}]]>
	</queryString>
	<field name="num_nota_devolutiva" class="java.lang.String"/>
	<field name="fecha" class="java.lang.String"/>
	<field name="inscripcion" class="java.lang.Boolean"/>
	<field name="firma" class="java.lang.String"/>
	<field name="elaborado" class="java.lang.String"/>
	<field name="nota_para" class="java.lang.String"/>
	<field name="asunto" class="java.lang.String"/>
	<field name="fecha_ingreso" class="java.sql.Timestamp"/>
	<field name="hecho" class="java.lang.String"/>
	<field name="juridica" class="java.lang.String"/>
	<field name="descripcion" class="java.lang.String"/>
	<field name="repertorio" class="java.lang.Integer"/>
	<field name="fecha_pago" class="java.sql.Timestamp"/>
	<field name="codigo_comprobante" class="java.lang.String"/>
	<field name="anio" class="java.lang.String"/>
	<field name="num_tramite" class="java.lang.Long"/>
	<background>
		<band height="840" splitType="Stretch">
			<image scaleImage="FillFrame" hAlign="Center" vAlign="Middle">
				<reportElement x="-69" y="0" width="593" height="840" uuid="a157dd5e-8879-4e2a-a355-65e37cf5beb9"/>
				<imageExpression><![CDATA[$P{WATERMARK_URL}]]></imageExpression>
			</image>
		</band>
	</background>
	<pageHeader>
		<band height="90" splitType="Stretch"/>
	</pageHeader>
	<detail>
		<band height="120" splitType="Stretch">
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement style="style_bold" x="0" y="0" width="455" height="20" isPrintWhenDetailOverflows="true" uuid="4e767537-f529-4f18-a359-85df45ff787b"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="10" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA["Nota Devolutiva # " + $F{num_nota_devolutiva}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="&apos;Machala, &apos; dd &apos;de&apos; MMMMM &apos;del&apos; yyyy" isBlankWhenNull="true">
				<reportElement style="style_bold" x="0" y="20" width="455" height="20" isPrintWhenDetailOverflows="true" uuid="c23cde17-fdca-4fef-8f5d-7c0ce434eac7"/>
				<textElement textAlignment="Right" verticalAlignment="Middle">
					<font size="10" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{fecha_ingreso}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement positionType="Float" x="135" y="56" width="320" height="20" isPrintWhenDetailOverflows="true" uuid="187b6788-a40b-4804-8ca8-ceb7a97c2022"/>
				<textElement verticalAlignment="Middle">
					<font size="10"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{asunto}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement style="style_bold" positionType="Float" x="0" y="56" width="135" height="20" isPrintWhenDetailOverflows="true" uuid="17293e29-9033-4aea-9959-f42a9c0529b7"/>
				<textElement verticalAlignment="Middle">
					<font size="10" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA["Asunto:"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement style="style_bold" positionType="Float" x="0" y="96" width="135" height="20" isPrintWhenDetailOverflows="true" uuid="5b003e07-b5ad-477a-9f70-1ccaf4bacddd">
					<printWhenExpression><![CDATA[$F{inscripcion}]]></printWhenExpression>
				</reportElement>
				<textElement verticalAlignment="Middle">
					<font size="10" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA["Repertorio:"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement style="style_bold" positionType="Float" x="0" y="76" width="135" height="20" isPrintWhenDetailOverflows="true" uuid="77df2570-2e04-4616-996f-153ab3b94870"/>
				<textElement verticalAlignment="Middle">
					<font size="10" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA["Fecha de Ingreso:"]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" pattern="dd &apos;de&apos; MMMMM &apos;del&apos; yyyy" isBlankWhenNull="true">
				<reportElement positionType="Float" x="135" y="76" width="320" height="20" isPrintWhenDetailOverflows="true" uuid="e4bb237d-fcb1-4156-bcfa-a174b47dcc51"/>
				<textElement verticalAlignment="Middle">
					<font size="10" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{fecha_pago}]]></textFieldExpression>
			</textField>
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement positionType="Float" x="135" y="96" width="320" height="20" isPrintWhenDetailOverflows="true" uuid="43fd5e8d-619b-470e-aec7-aad9169c5d3d">
					<printWhenExpression><![CDATA[$F{inscripcion}]]></printWhenExpression>
				</reportElement>
				<textElement verticalAlignment="Middle">
					<font size="10"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{repertorio}]]></textFieldExpression>
			</textField>
		</band>
		<band height="114" splitType="Stretch">
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement style="html" x="0" y="0" width="455" height="114" isPrintWhenDetailOverflows="true" uuid="f2168236-4cfd-4c48-b6eb-b589a513d4d0"/>
				<textElement textAlignment="Justified" verticalAlignment="Top" markup="html">
					<font size="10" isBold="false" isStrikeThrough="false" pdfEncoding="Cp1252" isPdfEmbedded="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{descripcion}]]></textFieldExpression>
			</textField>
		</band>
		<band height="200" splitType="Stretch">
			<staticText>
				<reportElement style="style_bold" x="0" y="18" width="200" height="16" isRemoveLineWhenBlank="true" isPrintWhenDetailOverflows="true" uuid="5b63c15b-001b-4273-9207-e883bfe74c65"/>
				<textElement verticalAlignment="Middle">
					<font size="8" isBold="false"/>
				</textElement>
				<text><![CDATA[Base Normativa]]></text>
			</staticText>
			<staticText>
				<reportElement x="0" y="34" width="456" height="160" isRemoveLineWhenBlank="true" isPrintWhenDetailOverflows="true" uuid="fa758b39-042e-41da-b56a-5081ebdaa2ae"/>
				<textElement textAlignment="Justified" verticalAlignment="Top">
					<font size="8" isBold="false"/>
				</textElement>
				<text><![CDATA[De conformidad al Art. 227 de la Constitución de la República del Ecuador La administración pública constituye un servicio a la colectividad que se rige por los principios de eficacia, eficiencia, calidad, jerarquía, desconcentración, descentralización, coordinación, participación, planificación, transparencia y evaluación.

Según los artículos 1, 2 y 3 de la Resolución Nro. 010-NG-DINARDAP-2017 - Norma que Regula la Emisión de Notas Devolutivas Registrales, El registrador informa al interesado las razones “errores de forma”, susceptibles de subsanación por las cuales no se practica la inscripción.

De conformidad al Art. 13 de la Ley de Registro. - Se le pone en conocimiento al interesado que el repertorio asignado al momento que ingresó el documento, caducará dentro del plazo de dos meses contados a partir de la fecha de apertura del repertorio.

Este documento está firmado electrónicamente, según lo que establece la Ley de Comercio Electrónico, Firmas y Mensajes de Datos, en los artículos 13, 14, 15, 16, y 17 en concordancia con la Ley Orgánica del Sistema Nacional del Registro de Datos Públicos, en sus artículos 12 y 23 inciso 3.
]]></text>
			</staticText>
		</band>
		<band height="142" splitType="Stretch">
			<textField isStretchWithOverflow="true" isBlankWhenNull="true">
				<reportElement x="0" y="16" width="455" height="16" isPrintWhenDetailOverflows="true" uuid="539ce10d-6f58-457a-9dac-f4e5f264601f"/>
				<textElement verticalAlignment="Middle">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{juridica}.toUpperCase()]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement style="style_bold" x="0" y="0" width="100" height="16" isRemoveLineWhenBlank="true" isPrintWhenDetailOverflows="true" uuid="4202f26a-3f00-48e5-b354-9d74bc843454"/>
				<textElement verticalAlignment="Middle">
					<font size="8" isBold="false"/>
				</textElement>
				<text><![CDATA[Elaborado por:]]></text>
			</staticText>
			<textField isBlankWhenNull="true">
				<reportElement style="style_bold" x="105" y="100" width="250" height="42" isPrintWhenDetailOverflows="true" uuid="d5bd4f5e-f647-4b59-90ea-f32a76e759e6"/>
				<box>
					<topPen lineWidth="1.0"/>
				</box>
				<textElement textAlignment="Center" verticalAlignment="Top">
					<font size="10" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{REGISTRADOR}]]></textFieldExpression>
			</textField>
		</band>
	</detail>
	<pageFooter>
		<band height="60" splitType="Stretch">
			<textField>
				<reportElement x="335" y="0" width="80" height="14" uuid="f9830bbb-6662-415f-afbb-e15d265d34cb"/>
				<textElement textAlignment="Right">
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA["Pág. "+$V{PAGE_NUMBER}+" de"]]></textFieldExpression>
			</textField>
			<textField evaluationTime="Report">
				<reportElement x="415" y="0" width="40" height="14" uuid="f241d60d-62ad-4b8c-9974-f066b1d0a704"/>
				<textElement>
					<font size="8"/>
				</textElement>
				<textFieldExpression><![CDATA[" " + $V{PAGE_NUMBER}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="2" y="0" width="55" height="9" isRemoveLineWhenBlank="true" isPrintWhenDetailOverflows="true" uuid="6279655b-53f3-42da-b609-3bab98598921"/>
				<textElement verticalAlignment="Middle">
					<font size="6" isBold="false"/>
				</textElement>
				<text><![CDATA[Nº de Trámite:]]></text>
			</staticText>
			<textField pattern="" isBlankWhenNull="true">
				<reportElement x="57" y="0" width="142" height="9" isPrintWhenDetailOverflows="true" uuid="c98d2141-ae2c-481b-a1a0-aad5a1ddb0bd">
					<printWhenExpression><![CDATA[$F{num_tramite} != null]]></printWhenExpression>
				</reportElement>
				<textElement verticalAlignment="Middle">
					<font size="6" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$F{anio}+"-"+$F{num_tramite}]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="2" y="9" width="55" height="9" isRemoveLineWhenBlank="true" isPrintWhenDetailOverflows="true" uuid="c4bbb5f9-ac40-4f63-81af-246077d72153"/>
				<textElement verticalAlignment="Middle">
					<font size="6" isBold="false"/>
				</textElement>
				<text><![CDATA[Impreso por:]]></text>
			</staticText>
			<textField isBlankWhenNull="true">
				<reportElement x="57" y="9" width="142" height="9" isPrintWhenDetailOverflows="true" uuid="a19a9e99-67ee-4022-976f-9bfa015b36af"/>
				<textElement verticalAlignment="Middle">
					<font size="6" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[$P{USUARIO}.toUpperCase()]]></textFieldExpression>
			</textField>
			<staticText>
				<reportElement x="2" y="18" width="55" height="9" isRemoveLineWhenBlank="true" isPrintWhenDetailOverflows="true" uuid="e6c51bd3-8a0a-4573-acb6-8f2be502f239"/>
				<textElement verticalAlignment="Middle">
					<font size="6" isBold="false"/>
				</textElement>
				<text><![CDATA[F. Impresión:]]></text>
			</staticText>
			<textField pattern="dd/MM/yyyy HH:mm" isBlankWhenNull="true">
				<reportElement x="57" y="18" width="142" height="9" isPrintWhenDetailOverflows="true" uuid="2137fd56-4f9c-4cb9-b63b-5c153cf7c47a"/>
				<textElement verticalAlignment="Middle">
					<font size="6" isBold="false"/>
				</textElement>
				<textFieldExpression><![CDATA[new java.util.Date()]]></textFieldExpression>
			</textField>
		</band>
	</pageFooter>
</jasperReport>
