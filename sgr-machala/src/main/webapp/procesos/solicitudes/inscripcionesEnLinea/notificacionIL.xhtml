<?xml version='1.0' encoding='UTF-8' ?>
<!DOCTYPE composition PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<ui:composition xmlns="http://www.w3.org/1999/xhtml"
                template="/template/bpmTemplate.xhtml"
                xmlns:f="http://java.sun.com/jsf/core"
                xmlns:h="http://java.sun.com/jsf/html"
                xmlns:ui="http://java.sun.com/jsf/facelets"
                xmlns:p="http://primefaces.org/ui">
    <ui:define name="content">
        <h:form id="mainForm">
            <h2><center style="text-transform: uppercase;">#{notificarSolicitudInscripcionMB.taskDataByTaskID.name}</center></h2>
            <p:tabView id="tabFormulario" >
                <p:tab title="1. Datos  del Solicitante">

                    <p:panelGrid  styleClass="ui-panelgrid-blank" columnClasses="thirty-percent, seventy-percent" columns="1" layout="grid" >
                        <h:panelGroup>
                            <h:panelGrid id="pnlSolicitante" columns="2" style=" font-weight: bolder">
                                <h:panelGroup>
                                    Actos a inscribir<br></br>
                                    <p:dataList id="dtActos" var="acto" value="#{notificarSolicitudInscripcionMB.actos}" rowIndexVar="index" >
                                        <p:column headerText="Requisito">
                                            <p:outputLabel value="#{acto.acto.nombre}"  />   
                                        </p:column> 
                                    </p:dataList>
                                </h:panelGroup> 
                                <h:panelGroup></h:panelGroup>
                                <h:panelGroup>
                                    <p:outputLabel for="solTipoPersona" value="Tipo Documento:"  /> <br/>
                                    <p:selectOneMenu id="solTipoPersona" value="#{notificarSolicitudInscripcionMB.solicitud.solTipoDoc}" disabled="true">
                                        <f:selectItem itemLabel="Cédula" itemValue="C"/>
                                        <f:selectItem itemLabel="Ruc" itemValue="J"/>
                                        <f:selectItem itemLabel="Pasaporte" itemValue="P"/>
                                        <p:ajax update="pnlSolicitante"/>
                                    </p:selectOneMenu>
                                </h:panelGroup>
                                <h:panelGroup >
                                    <p:outputLabel for="cedRuc" value="Identificación:"  /> <br/>
                                    <p:inputText id="cedRuc" value="#{notificarSolicitudInscripcionMB.solicitud.solCedula}" size="40"  required="true" readonly="true"/>
                                </h:panelGroup>
                                <h:panelGroup >
                                    <p:outputLabel for="nombres" value="Nombres:" rendered="#{notificarSolicitudInscripcionMB.solicitud.solTipoDoc ne 'J'}"/>
                                    <p:outputLabel for="nombres" value="Razón Social:" rendered="#{notificarSolicitudInscripcionMB.solicitud.solTipoDoc eq 'J'}"/> <br/>
                                    <p:inputText id="nombres" value="#{notificarSolicitudInscripcionMB.solicitud.solNombres}" size="40"   required="true" readonly="true" 
                                                 style="text-transform: uppercase"/>
                                </h:panelGroup>
                                <h:panelGroup rendered="#{notificarSolicitudInscripcionMB.solicitud.solTipoDoc ne 'J'}">
                                    <p:outputLabel for="apellidos" value="Apellidos:"  /> <br/>
                                    <p:inputText id="apellidos" value="#{notificarSolicitudInscripcionMB.solicitud.solApellidos}" size="40"  style="text-transform: uppercase" required="true" readonly="true"/>
                                </h:panelGroup>

                                <h:panelGroup >
                                    <p:outputLabel for="direccion" value="Dirección:"/> <br/>
                                    <p:inputText id="direccion" value="#{notificarSolicitudInscripcionMB.solicitud.solProvincia}" size="40" style="text-transform: uppercase" required="true" readonly="true"/>
                                </h:panelGroup>
                                <h:panelGroup >
                                    <p:outputLabel value="Celular:"  /> <br/>
                                    <p:inputText value="#{notificarSolicitudInscripcionMB.solicitud.solCelular}" size="40" required="true" readonly="true"/>
                                </h:panelGroup>
                                <h:panelGroup >
                                    <p:outputLabel for="telefono2" value="Convencional:"  /> <br/>
                                    <p:inputText id="telefono2" value="#{notificarSolicitudInscripcionMB.solicitud.solConvencional}" maxlength="10" size="40" />
                                </h:panelGroup>
                                <h:panelGroup >
                                    <p:outputLabel for="correo1" value="Correo:"  /> <br/>
                                    <p:inputText id="correo1" value="#{notificarSolicitudInscripcionMB.solicitud.solCorreo}" size="40" required="true" readonly="true"/>
                                </h:panelGroup>

                                <h:panelGroup rendered="#{notificarSolicitudInscripcionMB.solicitud.solTipoDoc ne 'J'}">
                                    <p:outputLabel for="estadoCivil" value="Estado Civil:" />
                                    <p:selectOneMenu id="estadoCivil" value="#{notificarSolicitudInscripcionMB.solicitud.solEstadoCivil}" required="true" disabled="true">
                                        <f:selectItem itemLabel="Seleccione" itemValue="#{null}"/>
                                        <f:selectItem itemLabel="Soltero" itemValue="S"/>
                                        <f:selectItem itemLabel="Casado" itemValue="C"/>
                                        <f:selectItem itemLabel="Divorciado" itemValue="D"/>
                                        <f:selectItem itemLabel="Unión Libre" itemValue="U"/>
                                        <f:selectItem itemLabel="Viudo" itemValue="V"/>
                                        <f:selectItem itemLabel="Célibe" itemValue="E"/>
                                        <p:ajax update="pnlConyugue"/>
                                    </p:selectOneMenu>
                                </h:panelGroup>

                            </h:panelGrid>
                            <h:panelGrid id="pnlConyugue" columns="2" style="font-weight: bolder">
                                <h:panelGroup id="propConyugueCedula" rendered="#{notificarSolicitudInscripcionMB.solicitud.solTipoDoc ne 'J' and notificarSolicitudInscripcionMB.solicitud.solEstadoCivil eq 'C'}">
                                    <p:outputLabel value="Cédula Cónyuge:" /> <br/>
                                    <p:inputText value="#{notificarSolicitudInscripcionMB.solicitud.propConyugueCedula}" size="40" style="text-transform: uppercase" />
                                </h:panelGroup>

                                <h:panelGroup id="propConyugueNombres" rendered="#{notificarSolicitudInscripcionMB.solicitud.solTipoDoc ne 'J'  and notificarSolicitudInscripcionMB.solicitud.solEstadoCivil eq 'C'}">
                                    <p:outputLabel value="Nombres Cónyuge:" /> <br/>
                                    <p:inputText value="#{notificarSolicitudInscripcionMB.solicitud.propConyugueNombres}" size="40" style="text-transform: uppercase" />
                                </h:panelGroup>

                                <h:panelGroup id="propConyugueApellidos" rendered="#{notificarSolicitudInscripcionMB.solicitud.solTipoDoc ne 'J'  and notificarSolicitudInscripcionMB.solicitud.solEstadoCivil eq 'C'}">
                                    <p:outputLabel value="Apellidos Cónyuge:" /> <br/>
                                    <p:inputText value="#{notificarSolicitudInscripcionMB.solicitud.propConyugueApellidos}" size="40" style="text-transform: uppercase"/>
                                </h:panelGroup>

                            </h:panelGrid>
                            <h:panelGrid  columns="1" styleClass="ui-panelgrid-blank" style="font-weight: bolder; ">
                                <h:panelGroup>
                                    <p:outputLabel value="Observación a la Solicitud:"  /> <br/>
                                    <p:inputTextarea value="#{notificarSolicitudInscripcionMB.solicitud.observacion}"
                                                     readonly="true" style="text-transform: uppercase"
                                                     cols="60" rows="5" />
                                </h:panelGroup>
                            </h:panelGrid>

                        </h:panelGroup>
                        <h:panelGroup>
                            <h:panelGrid id="solicitudRechazo" columns="1" style="width: 100%"  >
                                <h:panelGroup >
                                    <p:outputLabel   value="Notificación de requisitos" style="font-weight: bold" /><br/> <br/> 
                                    <p:outputLabel   value="Para: #{notificarSolicitudInscripcionMB.solicitud.solNombres}" style="font-weight: bold" /><br/>
                                    <p:outputLabel   value="Asunto: Notificación de observaciones" style="font-weight: bold" /><br/> <br/>
                                    <p:outputLabel  value="Actos" style="font-weight: bold"/><br/> 
                                    <p:selectOneMenu  id="actos" value="#{notificarSolicitudInscripcionMB.acto}"  
                                                      style=" width: 50% !important"  filter="true" filterMatchMode="startsWith" converter="dtoConverter" > 
                                        <p:ajax event="change" listener="#{notificarSolicitudInscripcionMB.cargarRequisitos()}" update="actos, menuRequisitos"  />
                                        <f:selectItems value="#{notificarSolicitudInscripcionMB.actosEnLinea}" var="ac" itemLabel="#{ac.acto}"  itemValue="#{ac}" />
                                    </p:selectOneMenu ><br/>
                                    <p:outputLabel  value="Requisitos" style="font-weight: bold"/><br/> 
                                    <p:selectCheckboxMenu id="menuRequisitos" label="Seleccione Requisitos" value="#{notificarSolicitudInscripcionMB.requisitosSeleccionados}" 
                                                          style="width: 50% !important" panelStyle="width: 50% !important" filter="true" filterMatchMode="contains"   converter="dtoConverter" >
                                        <p:ajax event="change" listener="#{notificarSolicitudInscripcionMB.selccionarRequisitos()}" update="dtequisitosNotificar"  />
                                        <f:selectItems value="#{notificarSolicitudInscripcionMB.actosRequisitos}" var="doc" 
                                                       itemLabel="#{doc.requisito}" itemValue="#{doc}" />
                                    </p:selectCheckboxMenu> <br/>
                                    <p:outputLabel  value=" Requisitos a corregir" style="font-weight: bold"/><br/> 
                                    <p:dataList id="dtequisitosNotificar" var="req"
                                                style="width: 50% !important" 
                                                emptyMessage="No se han agregado requisitos" value="#{notificarSolicitudInscripcionMB.requisitosNotificar}" rowIndexVar="index" >
                                        <p:column headerText="Requisito">
                                            <p:outputLabel value="#{req.requisito.requisito}"  />   
                                        </p:column> 
                                        <p:column headerText="Accion">
                                            <p:commandLink actionListener="#{notificarSolicitudInscripcionMB.removerRequisito(index)}" update="dtequisitosNotificar">
                                                <p:graphicImage value="/resources/icons/trash.png" height="20" width="20"/>   
                                            </p:commandLink>

                                        </p:column> 
                                    </p:dataList>
                                </h:panelGroup>
                                <h:panelGroup   >
                                    <p:textEditor id="notificacion" widgetVar="editor2" secure="false" 
                                                  value="#{notificarSolicitudInscripcionMB.solicitud.notificacion}"  
                                                  style="height: 100%; width: 100%" height="150" >
                                        <f:facet name="toolbar">
                                            <span class="ql-formats">
                                                <button class="ql-bold"></button>
                                            </span> 
                                        </f:facet>
                                    </p:textEditor>
                                    <br/><br/>
                                    <br/><br/>
                                </h:panelGroup>

                            </h:panelGrid>
                        </h:panelGroup>
                    </p:panelGrid>

                </p:tab>
                <p:tab title="2. Datos para la factura ">
                    <h:panelGrid id="pnlBeneficiario" columns="2" styleClass="ui-panelgrid-blank"
                                 style="margin: 0 auto; font-weight: bolder">
                        <h:panelGroup>
                            <p:outputLabel for="benTipoDoc" value="Tipo Documento"  /> <br/>
                            <p:selectOneMenu id="benTipoDoc" value="#{notificarSolicitudInscripcionMB.solicitud.benTipoDoc}" required="true" disabled="true">
                                <f:selectItem itemLabel="Cédula" itemValue="N"/>
                                <f:selectItem itemLabel="Jurídica" itemValue="J"/>
                                <f:selectItem itemLabel="Pasaporte" itemValue="P"/>
                                <p:ajax update="pnlBeneficiario"/>
                            </p:selectOneMenu>
                        </h:panelGroup>
                        <h:panelGroup>
                            <p:outputLabel for="benDocumento" value="Identificación:" /> <br/>
                            <p:inputText id="benDocumento" value="#{notificarSolicitudInscripcionMB.solicitud.benDocumento}" size="40" required="true" readonly="true" />
                        </h:panelGroup>
                        <h:panelGroup>
                            <p:outputLabel for="benNombres" value="Nombres:" /> <br/>
                            <p:inputText id="benNombres" value="#{notificarSolicitudInscripcionMB.solicitud.benNombres}" size="40" required="true" readonly="true" />
                        </h:panelGroup>
                        <h:panelGroup>
                            <p:outputLabel for="benApellidos" value="Apellidos:" /> <br/>
                            <p:inputText id="benApellidos" value="#{notificarSolicitudInscripcionMB.solicitud.benApellidos}" size="40" required="true" readonly="true" />
                        </h:panelGroup>

                        <h:panelGroup>
                            <p:outputLabel for="benDireccion" value="Dirección:" /> <br/>
                            <p:inputText id="benDireccion" value="#{notificarSolicitudInscripcionMB.solicitud.benDireccion}" size="40" required="true" readonly="true" />
                        </h:panelGroup>
                        <h:panelGroup>
                            <p:outputLabel for="benTelefono" value="Teléfono:" /> <br/>
                            <p:inputText id="benTelefono" value="#{notificarSolicitudInscripcionMB.solicitud.benTelefono}" size="40" required="true" readonly="true" />
                        </h:panelGroup>
                        <h:panelGroup>
                            <p:outputLabel for="benCorreo" value="Correo:" /> <br/>
                            <p:inputText id="benCorreo" value="#{notificarSolicitudInscripcionMB.solicitud.benCorreo}" size="40" required="true" readonly="true" />
                        </h:panelGroup>

                    </h:panelGrid>

                </p:tab>
                <p:tab title="3. Requisitos">
                    <br/>
                    <br/>
                    <p:dataTable id="dtRequisitos" var="req" value="#{notificarSolicitudInscripcionMB.requisitos}" rowIndexVar="index" >

                        <p:column headerText="Requisito">
                            <p:outputLabel value="#{req.requisito.requisito}"  />   
                        </p:column>

                        <p:column headerText="Descargar" width="100">

                            <p:commandLink actionListener="#{notificarSolicitudInscripcionMB.downLoadDocument(req.documento)}">
                                <p:graphicImage value="/resources/icons/documento.png" height="20" width="20"/>   
                            </p:commandLink>

                        </p:column>
                    </p:dataTable>

                </p:tab>



            </p:tabView>
            <br/>
            <br/>
            <center>
                <h:panelGrid id="pnlAprobacion" columns="3" style="font-size: 16px;" >
                    <p:commandButton value="Completar Tarea" icon="pi pi-check" 
                                     style="font-size: 16px;background-color: darkcyan;"
                                     actionListener="#{notificarSolicitudInscripcionMB.completarTarea()}">
                        <p:confirm header="Confirma" message="Esta seguro de enviar la notificación?" 
                                   icon="pi pi-exclamation-triangle" />
                    </p:commandButton>                     
                </h:panelGrid>
            </center>
            <br/>
            <br/><br/>
            <br/><br/>
            <br/>
            <p:confirmDialog global="true" showEffect="fade" hideEffect="fade">
                <p:commandButton value="Si" type="button" styleClass="ui-confirmdialog-yes" icon="fa fa-check" />
                <p:commandButton value="No" type="button" styleClass="ui-confirmdialog-no" icon="fa fa-times" />
            </p:confirmDialog>     


        </h:form>

        <p:dialog id="dlgObervaciones" widgetVar="dlgObsvs" header="Confirmar Tarea" modal="true" width="400" 
                  resizable="false" position="center">
            <h:form id="formObs">
                <center>
                    <p:outputLabel value="Ingrese una observación" style="font-weight: bolder;font-size: 16px; color: green"/>
                </center>
                <br></br>
                <p:inputTextarea value="#{notificarSolicitudInscripcionMB.observacion}" rows="5" autoResize="false"
                                 style="width: 100%" maxlength="900"/>
                <br/><br/>
                <center>
                    <p:commandButton value="Aceptar"   icon="ui-icon-check"
                                     actionListener="#{notificarSolicitudInscripcionMB.completarTarea()}"/>
                </center>
            </h:form>
        </p:dialog>


    </ui:define>
</ui:composition>